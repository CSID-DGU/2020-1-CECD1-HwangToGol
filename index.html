<!--https://github.com/TakashiYoshinaga/Oculus-Quest-Input-Sample-->
<!DOCTYPE html>
<html>

<head>
  <style>
    body {
      background-image: url(/image/sky.jpg);
    }
  </style>
  <meta charset="utf-8">
  <title>Oculus Quest Input</title>
  <meta name="description" content="Oculus Quest Input">
  <script src="https://aframe.io/releases/0.9.2/aframe.min.js"></script>
</head>

<body>
  <script src="/components/index.js"></script>
  <script src="/components/ball.js"></script>
  <script>  
    AFRAME.registerComponent('gate', {
      schema: {
        name: { default: 'gate0' },
        color: { default: '#0054FF' },
        size: { type: 'int', default: 10 },
      },

      init: function () {     //component가 처음 초기화될 때 호출
        console.log("log 확인 : ", this.name);
      },
      update: function () { },        //component가 처음 초기화될때, component의 속성이 변경될 때 호출 : entity 수정할 때 사용
      tick: function () { },          //render loop가 호출될 때 마다 호출  : 계속되는 변화를 체크할 때 사용 
      remove: function () { },        //component가 entity에서 제거될때, scene에서 분리될 때 호출 : 이전에 있던 entity에 대한 모든 수정사항을 취소할때 사용 
      pause: function () { },         //component가 entity에서 제거 혹은 entity가 scene에서 분리될 때 : scene이나 entity가 정지할 때 호출됨.
      play: function () { }           //scene이나 entity가 작동될때, component가 초기화될 때 한번 호출됨. : 행동을 시작하거나 계속할 때 사용
    })

    AFRAME.registerComponent('input-listener', {
      //Definition of right or left hand as a controller's property.
      schema: {
        hand: { type: "string", default: "" }
      },
      //Initialization
      init: function () {
        this.el.txt = document.getElementById("txt");
        this.el.txt2 = document.getElementById("txt2");
        //Stick Moved
        this.el.addEventListener('axismove', function (event) {
          this.txt.setAttribute("value", "Stick  x:" + event.detail.axis[0].toFixed(2) + ", y:" + event.detail.axis[1].toFixed(2));
        });
        //Trigger Touch Started
        this.el.addEventListener('triggertouchstart', function (event) {
          this.txt.setAttribute("value", "Trigger touch started ");
        });
        //Trigger Touch Ended
        this.el.addEventListener('triggertouchend', function (event) {
          this.txt.setAttribute("value", "Trigger touch ended");
        });
        //Trigger Pressed
        this.el.addEventListener('triggerdown', function (event) {
          this.txt.setAttribute("value", "Trigger down");
        });
        //Trigger Released
        this.el.addEventListener('triggerup', function (event) {
          this.txt.setAttribute("value", "Trigger up");
        });
        //Grip Pressed
        this.el.addEventListener('gripdown', function (event) {
          this.txt.setAttribute("value", "Gipdown down");
        });
        //Grip Released
        this.el.addEventListener('gripup', function (event) {
          this.txt.setAttribute("value", "Gripdown up");
        });
        //A-buttorn Pressed 
        this.el.addEventListener('abuttondown', function (event) {
          this.txt.setAttribute("value", "A-button down");
        });
        //A-buttorn Released
        this.el.addEventListener('abuttonup', function (event) {
          this.txt.setAttribute("value", "A-button up");
        });
        //B-buttorn Pressed
        this.el.addEventListener('bbuttondown', function (event) {
          this.txt.setAttribute("value", "B-button down");
        });
        //B-buttorn Released
        this.el.addEventListener('bbuttonup', function (event) {
          this.txt.setAttribute("value", "B-button up");
        });
        //Y-buttorn Pressed 
        this.el.addEventListener('ybuttondown', function (event) {
          this.txt.setAttribute("value", "Y-button down");
        });
        //Y-buttorn Released
        this.el.addEventListener('ybuttonup', function (event) {
          this.txt.setAttribute("value", "Y-button up");
        });
        //X-buttorn Pressed
        this.el.addEventListener('xbuttondown', function (event) {
          this.txt.setAttribute("value", "X-button down");
        });
        //X-buttorn Released
        this.el.addEventListener('xbuttonup', function (event) {
          this.txt.setAttribute("value", "X-button up");
        });
      },

      //called evry frame
      tick: function () {
        //Position of righ-hand controller is shown in real-time.
        if (this.data.hand == "right") {
          var p = this.el.object3D.position;
          this.el.txt2.setAttribute("value", "R-Position: " + p.x.toFixed(2) + ", " + p.y.toFixed(2) + ", " + p.z.toFixed(2));
        }
      }
    });
    
  </script>

  <!-- <a-scene background="color: #FAFAFA">
      <a-box position="-1 0.5 -3" rotation="0 45 0" color="#4CC3D9" shadow></a-box>
      <a-sphere position="0 1.25 -5" radius="1.25" color="#EF2D5E" shadow></a-sphere>
      <a-cylinder position="1 0.75 -3" radius="0.5" height="1.5" color="#FFC65D" shadow></a-cylinder>
      <a-plane position="0 0 -4" rotation="-90 0 0" width="4" height="4" color="#7BC8A4" shadow></a-plane>
      <a-entity id="ctlL" laser-controls="hand: left" input-listener="hand: left"></a-entity>
      <a-entity id="ctlR" laser-controls="hand: right" input-listener="hand: right"></a-entity>
      <a-entity camera look-controls position="0 1.6 0">
        <a-text id="txt" value="" position="0 0 -1" scale="0.4 0.4 0.4" align="center" color="#000000"></a-text>
        <a-text id="txt2" value="" position="0 -0.15 -1" scale="0.4 0.4 0.4" align="center" color="#000000"></a-text>
      </a-entity>
    </a-scene>    -->
  <a-scene>
    <a-assets>
      <img id=ground src="/image/ground.jpg" />
      <img id=ball src="image/golfball.jpg" />
      <img id=gate src="image/gate.jpg"/>
    </a-assets>
    <a-sphere id=ball src=#ball ball="" position="0 1.25 -5" radius="1.25" shadow></a-sphere>
    <a-box id=gate src=#gate gate = "testgate" position="-1 0.5 -3" width="0.1" height="1" rotation="0 45 0" shadow></a-box>
    <a-plane id="ground" src=#ground position="-10 -500 -3" rotation="-90 0 0" width="10000" height="10000" color="#E8D9FF"
      shadow></a-plane>
    <a-entity id="ctlL" laser-controls="hand: left" input-listener="hand: left"></a-entity>
    <a-entity id="ctlR" laser-controls="hand: right" input-listener="hand: right"></a-entity>
    <a-entity camera look-controls position="0 1.6 0">
      <a-text id="txt" value="" position="0 0 -1" scale="0.4 0.4 0.4" align="center" color="#000000"></a-text>
      <a-text id="txt2" value="" position="0 -0.15 -1" scale="0.4 0.4 0.4" align="center" color="#000000"></a-text>
    </a-entity>
  </a-scene>
</body>

</html> 
